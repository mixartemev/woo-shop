(function(e){"use strict";var t=window.penshop||{};t.init=function(){this.$window=e(window);this.$body=e(document.body);this.data=penShopData||{};this.toggleOffCanvas();this.toggleModal();this.togglePanel();this.instanceSearch();this.sideSubMenu();this.stickyHeader();this.stickySidebar();this.changeProductQuantity();this.productGallery();this.productQuickView();this.ajaxLoadProducts();this.ajaxLoadPortfolio();this.ajaxProductFilter();this.autoOpenCart();this.portfolioFilter();this.tooltip();this.prettyDropdown();this.goTop();this.wishlistCounter();this.addToWishlist();this.toggleLoginForms();this.popup();this.$body.trigger("penshop_initialized",[t])};t.toggleOffCanvas=function(){var o=e(".off-canvas-backdrop");t.$body.on("click",'[data-toggle="off-canvas"]',function(a){a.preventDefault();var n=e(a.currentTarget),i=e(n.data("target"));i.toggleClass("opened");t.$body.toggleClass("canvas-opened");o.fadeToggle()});t.$body.on("click",".off-canvas-backdrop, .off-canvas .close-btn",function(a){a.preventDefault();e(".off-canvas").removeClass("opened");t.$body.removeClass("canvas-opened").trigger("penshop_canvas_off");o.fadeOut()})};t.toggleModal=function(){t.$body.on("click",'[data-toggle="modal"]',function(o){o.preventDefault();var a=e(o.currentTarget),n=e(a.data("target"));n.fadeToggle(function(){n.toggleClass("opened")});t.$body.toggleClass("modal-opened")});t.$body.on("click",".modal .close-btn, .modal .close-trigger",function(o){o.preventDefault();e(o.currentTarget).closest(".modal").removeClass("opened").fadeOut();t.$body.removeClass("modal-opened").trigger("penshop_modal_close")})};t.togglePanel=function(){t.$body.on("click",'[data-toggle="panel"]',function(t){t.preventDefault();var o=e(t.currentTarget),a=o.data("target")?o.data("target"):o.attr("href"),n=e(a);if(!n.length){return}o.parents("ul").find('.active[data-toggle="panel"]').not(o).removeClass("active");n.siblings(".panel").stop(true,true).slideUp("normal",function(){e(this).removeClass("active");n.slideToggle("normal",function(){n.toggleClass("active");o.toggleClass("active")})})})};t.instanceSearch=function(){if(e().autocomplete){var o={},a=e("#modal-search"),n=a.find(".type-field");e(".search-field",a).autocomplete({minLength:2,source:function(a,i){var s=a.term,r=n.length?n.val():"",l=s+"|"+r;if(l in o){i(o[l]);return}e.post(t.data.ajax_url,{action:"penshop_search",term:s,type:r},function(e){o[l]=e.data;i(e.data)})},select:function(e,t){e.preventDefault();if(t.item.value!=="#"){location.href=t.item.value}},search:function(t){e(t.target).closest("form").addClass("ajax-loading")},response:function(t){e(t.target).closest("form").removeClass("ajax-loading")},create:function(){e(this).data("ui-autocomplete")._renderItem=function(t,o){return e('<li class="woocommerce"></li>').append('<a href="'+o.url+'">'+o.thumb+'<span class="title">'+o.value+'</span><span class="price">'+o.price+"</span></a>").appendTo(t)}}});var i={},s=e(".product-search-form"),r=e("select[name=product_cat]",s);e(".search-field.search-text",s).autocomplete({minLength:2,source:function(o,a){var n=o.term,s=r.length?r.val():"",l=n+"|"+s;if(l in i){a(i[l]);return}e.post(t.data.ajax_url,{action:"penshop_search",term:n,type:"product",cat:s},function(e){i[l]=e.data;a(e.data)})},select:function(e,t){e.preventDefault();if(t.item.url!=="#"){location.href=t.item.url}},search:function(t){e(t.target).closest("form").addClass("ajax-loading")},response:function(t){e(t.target).closest("form").removeClass("ajax-loading")},create:function(){e(this).data("ui-autocomplete")._renderItem=function(t,o){return e('<li class="woocommerce"></li>').append('<a href="'+o.url+'">'+o.thumb+'<span class="title">'+o.value+'</span><span class="price">'+o.price+"</span></a>").appendTo(t)}}})}var l=null,c={},d=e("#primary ul.products"),u=d.next(".woocommerce-pagination");e(".search-field","#search-panel").on("keyup",function(t){var o=false,a=e(this),n=e(this).closest("form"),i=a.val();if(typeof t.which==="undefined"){o=true}else if(typeof t.which==="number"&&t.which>0){o=!t.ctrlKey&&!t.metaKey&&!t.altKey}if(!o){return}if(l){l.abort()}var s=n.attr("action")+"?"+n.serialize();d.append('<li class="products-ajax-loading"><i class="fa fa-circle-o-notch fa-spin fa-fw"></i></li>');if(i in c){var r=c[i];p(r)}else{l=e.get(s,function(t){var o=e(t),a=e("#primary ul.products",o),n=e("#primary .woocommerce-info",o),r=null;if(a.length){r={found:true,url:s,products:a.children(),nav:a.next(".woocommerce-pagination")}}else{r={found:false,url:s,info:e("#primary .woocommerce-info",o)}}c[i]=r;p(r)},"html")}});var p=function(t){if(t.found){var o=t.products,a=t.nav;o.css("opacity",0);d.html(o);setTimeout(function(){o.css("opacity",1)},100);if(a.length){u.html(a.html())}else{u.html("")}}else{var n=t.info,i=e('<li class="col-sm-12" />').append(n);d.html(i);u.html("")}window.history.pushState(null,"",t.url)}};t.sideSubMenu=function(){e(".side-menu > .menu-item-has-children").each(function(){var t=e(this);if(t.hasClass("current-menu-item")||t.hasClass("current-menu-ancestor")){t.addClass("open")}t.children("a").append('<i class="fa fa-angle-right toggle-sub" />')});this.$body.on("click",".side-menu .toggle-sub",function(t){t.preventDefault();var o=e(this).closest("li");if(o.hasClass("open")){o.children("ul").slideUp(function(){o.removeClass("open")})}else{o.children("ul").slideDown();o.addClass("open")}})};t.stickyHeader=function(){if(!t.data.sticky_header||"none"===t.data.sticky_header){return}var o=e("#masthead"),a=e(".header-main",o),n=e("#topbar"),i=e("#wpadminbar"),s=1;if(n.length){s+=n.outerHeight()}if(i.length){s+=i.outerHeight()}if(t.$body.hasClass("header-layout-v1")){s+=e(".header-main",a).outerHeight();a=e("#site-navigation")}s+=a.outerHeight();if("smart"===t.data.sticky_header){var r=e('<div class="sticky-holder" />').height(a.outerHeight());a.after(r);var l=new Headroom(a.get(0),{offset:s,onTop:function(){a.removeClass("headroom--animation");o.removeClass("is-sticky");r.hide()},onNotTop:function(){setTimeout(function(){a.addClass("headroom--animation")},10);o.addClass("is-sticky");r.show()}});l.init()}else{a.sticky({topSpacing:i.length?i.outerHeight():0,zIndex:999})}};t.stickySidebar=function(){if(!t.data.sticky_sidebar){return}if(t.$body.hasClass("no-sidebar")){return}e(".content-area, .primary-sidebar").theiaStickySidebar()};t.changeProductQuantity=function(){t.$body.on("click",".quantity button",function(t){t.preventDefault();var o=e(this),a=o.siblings(".qty"),n=parseInt(a.val(),10),i=parseInt(a.attr("min"),10),s=parseInt(a.attr("max"),10);i=i?i:1;s=s?s:n+1;if(o.hasClass("decrease")&&n>i){a.val(n-1);a.trigger("change")}if(o.hasClass("increase")&&n<s){a.val(n+1);a.trigger("change")}})};t.productGallery=function(){e(".woocommerce-product-gallery").on("click",".woocommerce-product-gallery__image .zoomImg",function(){e(this).prev("a").trigger("click")});setTimeout(function(){var t=e(".woocommerce-product-gallery .flex-viewport").height()-50;e(".woocommerce-product-gallery__trigger").css("top",t)},100)};t.productQuickView=function(){t.$body.on("click",".quick-view-button",function(o){if(t.$window.width()<=768){return}o.preventDefault();var a=e(this).attr("href"),n=e("#modal-quick-view"),i=e(".container",n),s=n.children(".close-btn").clone();i.html("");n.removeClass("loaded");e.get(a,function(o){var r=e(o),l=e("div.product",r),c=e(".woocommerce-product-gallery",l),d=e(".variations_form",l);l.find(".breadcrumb, .woocommerce-tabs, .related, .upsells").remove();l.find("h1.product_title").wrapInner('<a href="'+a+'"></a>');l.prepend(s);i.append(l);if(e.fn.wc_product_gallery){c.wc_product_gallery({flexslider_enabled:true,zoom_enabled:true,photoswipe_enabled:false})}e(".social-share a",l).penTip();c.on("click","a",function(e){e.preventDefault()});d.wc_variation_form().find(".variations select:eq(0)").change();n.addClass("loaded");t.$body.trigger("penshop_quick_view_opened",[n,r,t]);console.log(n)})})};t.ajaxLoadProducts=function(){if("ajax"===t.data.shop_nav_type||"infinite"===t.data.shop_nav_type){t.$body.on("click",".woocommerce-pagination .next",function(t){t.preventDefault();var o=e(this),a=o.closest(".woocommerce-pagination"),n=a.prev("ul.products"),i=o.attr("href");if(o.hasClass("loading")){return}o.addClass("loading");l(i,n,function(t){var o=e(t).find(".woocommerce-pagination");if(o.length){a.html(o.html())}else{a.html("")}})})}if("infinite"===t.data.shop_nav_type){var o=e(".woocommerce-pagination"),a=o.find(".next"),n=e("ul.products");if(a.length){var i=false,s;t.$window.on("scroll",function(){if(i){return}i=true;clearTimeout(s);r();setTimeout(function(){i=false},100);s=setTimeout(function(){r()},200)})}var r=function(){if(t.isVisible(o)&&a.length){if(a.hasClass("loading")){return}a.addClass("loading");l(a.attr("href"),n,function(t){var n=e(t).find(".woocommerce-pagination");if(n.length){o.html(n.html());a=o.find(".next")}else{o.html("");a.length=0}})}}}function l(t,o,a){e.get(t,function(n){var i=e(n).find("#primary ul.products li.product");i.each(function(t,o){e(o).css("animation-delay",.15*t+"s")});i.addClass("penci-fadeInUp animated");o.append(i);if(o.hasClass("product-style-hidden_buttons")){e(".buttons a",i).penTip()}if("function"===typeof a){setTimeout(a(n),500)}window.history.pushState(null,"",t)})}};t.ajaxLoadPortfolio=function(){if(!t.$body.hasClass("post-type-archive-portfolio")&&!t.$body.hasClass("tax-portfolio_type")){return}var o=e(".portfolio-items"),a=o.next(".navigation");t.$body.on("click",".posts-navigation .nav-previous a",function(t){t.preventDefault();var n=e(this),i=n.attr("href");n.addClass("loading");e.get(i,function(t){var n=e(t).find("#primary"),s=e(".portfolio-items .portfolio",n),r=e(".navigation",n);o.append(s).isotope("appended",s);s.imagesLoaded().progress(function(){o.isotope("layout")});if(r.length){a.replaceWith(r)}else{a.fadeOut()}window.history.pushState(null,"",i)})})};t.isVisible=function(e){if(e instanceof jQuery){e=e[0]}var t=e.getBoundingClientRect();return t.bottom>0&&t.right>0&&t.left<(window.innerWidth||document.documentElement.clientWidth)&&t.top<(window.innerHeight||document.documentElement.clientHeight)};t.ajaxProductFilter=function(){var t=e("#shop-toolbar"),o=e("#filter-panel",t);t.on("click",".widget-products-order a, .widget-price-ranges a, .widget_layered_nav a, .widget_product_categories a, .widget_product_tag_cloud a",function(a){a.preventDefault();var n=e(this),i=n.attr("href"),s=t.next("ul.products"),r=s.next(".woocommerce-pagination");s.append('<li class="products-ajax-loading"><span class="fa-spin loading-icon"></span></li>');e.get(i,function(t){var a=e(t),n=e("#primary ul.products",a),l=e("#filter-panel",a);if(n.length){var c=n.children(),d=n.next(".woocommerce-pagination");c.css("opacity",0);s.html(c);setTimeout(function(){c.css("opacity",1)},100);if(d.length){r.html(d.html())}else{r.html("")}}else{var u=e("#primary .woocommerce-info",a),p=e('<li class="col-sm-12" />').append(u);s.html(p);r.html("")}o.html(l.html());window.history.pushState(null,"",i)})})};t.autoOpenCart=function(){if(!t.data.auto_open_cart){return}t.$body.on("added_to_cart",function(){e(".modal.opened").fadeOut(function(){e(this).removeClass("opened")});t.$body.removeClass("modal-opened");e(".off-canvas.opened").removeClass("opened");e("#off-canvas-cart").addClass("opened");t.$body.addClass("canvas-opened");e(".off-canvas-backdrop").fadeIn()})};t.portfolioFilter=function(){var o=e(".portfolio-items");if(!o.length){return}var a={itemSelector:".portfolio",transitionDuration:"0.7s",isOriginLeft:!(t.data.isRTL==="1")};if(o.hasClass("layout-fullwidth")){a.percentPosition=true;a.masonry={columnWidth:".portfolio-normal"}}else if(o.hasClass("layout-classic")){a.layoutMode="fitRows"}o.imagesLoaded(function(){e(this.elements).isotope(a)});var n=e(".portfolio-filter");n.on("click","li",function(t){t.preventDefault();var o=e(this),a=o.attr("data-filter");if(o.hasClass("active")){return}o.addClass("active").siblings(".active").removeClass("active");o.closest(".portfolio-filter").next(".portfolio-items").isotope({filter:a})})};t.tooltip=function(){e("ul.product-style-hidden_buttons .buttons a, .social-share a").penTip()};t.prettyDropdown=function(){e(".search-by-cat select").select2({minimumResultsForSearch:-1,dropdownCssClass:"product-cat-search"})};t.goTop=function(){var o=e(".gotop"),a=t.$window.height();if(!o.length){return}t.$window.on("scroll load",function(){if(t.$window.scrollTop()>a){o.addClass("active")}else{o.removeClass("active")}});o.on("click",function(t){t.preventDefault();e("html, body").animate({scrollTop:0},1e3)})};t.wishlistCounter=function(){var o=e(".wishlist-counter");if(!o.length){return}t.$body.on("added_to_wishlist",function(){o.text(parseInt(o.text())+1)}).on("removed_from_wishlist",function(){o.text(parseInt(o.text())-1)})};t.addToWishlist=function(){t.$body.on("click",".add_to_wishlist",function(t){t.preventDefault();e(this).addClass("loading")})};t.toggleLoginForms=function(){t.$body.on("click","#modal-login .toggle-register-form",function(t){t.preventDefault();e(this).closest(".col2-set").addClass("register")}).on("click","#modal-login .toggle-login-form",function(t){t.preventDefault();e(this).closest(".col2-set").removeClass("register")});e("#modal-login").on("click",".modal-backdrop",function(){e(this).next(".woocommerce").find(".col2-set").removeClass("register")})};t.popup=function(){var o=parseInt(t.data.popup_frequency),a=parseInt(t.data.popup_delay),n=e("#popup");if(!n.length){return}if(o>0&&document.cookie.match(/^(.*;)?\s*penshop_popup\s*=\s*[^;]+(.*)?$/)){return}a=Math.max(a,0);a="delay"===t.data.popup_visible?a:0;t.$window.on("load",function(){setTimeout(function(){n.fadeToggle(function(){n.toggleClass("opened")});t.$body.toggleClass("modal-opened")},a*1e3)});n.on("click",".close-trigger",function(){var e=new Date,t=e.getTime();e.setTime(e.getTime()+o*24*60*60*1e3);document.cookie="penshop_popup="+t+";expires="+e.toGMTString()+";path=/"})};e(function(){t.init()})})(jQuery);